import{u as b,E as w,r as l,j as e,a as h,i as r,v as F,W as c,ae as C}from"./index-urLV_LK0.js";import{C as k,I as P}from"./image-D9ZlnuO6.js";function z(){const[g]=b(),o=w(),i=g.get("session"),[s,j]=l.useState(null),[d,y]=l.useState(!1),[m,n]=l.useState(null),u=l.useRef(null),p=l.useRef(null);l.useEffect(()=>{i||o("/reimburse")},[i,o]);const x=a=>{const t=a.target.files?.[0];if(t){if(!["image/jpeg","image/jpg","image/png","image/webp","application/pdf"].includes(t.type)){n("Please upload a JPG, PNG, or PDF file");return}if(t.size>10*1024*1024){n("File size must be less than 10MB");return}j(t),n(null)}},N=async()=>{if(!(!s||!i))try{const a=new FileReader;a.onloadend=()=>{const t=a.result,f={name:s.name,size:`${(s.size/1024).toFixed(0)} KB`,type:s.type,data:t,timestamp:Date.now()},v=`reimburse-upload-${i}`;sessionStorage.setItem(v,JSON.stringify(f)),y(!0),setTimeout(()=>{window.close()},2e3)},a.onerror=()=>{n("Failed to read file. Please try again.")},a.readAsDataURL(s)}catch{n("Failed to upload file. Please try again.")}};return i?e.jsx("div",{className:"min-h-screen bg-[#F1FAFE] p-4",children:e.jsx("div",{className:"max-w-md mx-auto pt-8",children:e.jsx(h,{children:e.jsxs(h.Content,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Upload Receipt"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Take a photo or select from your gallery"})]}),d&&e.jsxs(r,{intent:"success",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(r.Title,{children:"Upload successful!"}),e.jsx(r.Description,{children:"Your receipt has been uploaded. You can close this page and return to your desktop."})]}),m&&e.jsxs(r,{intent:"destructive",children:[e.jsx(r.Title,{children:"Upload failed"}),e.jsx(r.Description,{children:m})]}),!d&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{ref:u,type:"file",accept:"image/*,.pdf",capture:"environment",onChange:x,className:"hidden"}),e.jsxs(c,{type:"button",intent:"primary",size:"lg",className:"w-full h-16",onClick:()=>{u.current?.click()},children:[e.jsx(k,{className:"h-5 w-5 mr-2"}),"Take Photo"]}),e.jsx("input",{ref:p,type:"file",accept:"image/*,.pdf",onChange:x,className:"hidden"}),e.jsxs(c,{type:"button",variant:"outline",size:"lg",className:"w-full h-16",onClick:()=>{p.current?.click()},children:[e.jsx(P,{className:"h-5 w-5 mr-2"}),"Choose from Gallery"]}),s&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg border-2 border-primary/20 bg-primary/5 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10",children:e.jsx(C,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s.size/1024).toFixed(0)," KB"]})]})]})}),e.jsx(c,{type:"button",intent:"primary",size:"lg",className:"w-full",onClick:N,children:"Upload Receipt"})]})]})]})})})}):null}export{z as default};
